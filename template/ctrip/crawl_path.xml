<?xml version="1.0" encoding="UTF-8"?>
<configs>
    <headers>
        <User-Agent>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36</User-Agent>
        <Accept-Language>zh-CN,zh;q=0.8</Accept-Language>
        <Accept-Encoding>gzip, deflate, sdch</Accept-Encoding>
        <Referer>Referer: http://vacations.ctrip.com/</Referer>
    </headers>
    <parameters>
        <interval_min>500</interval_min>
        <interval_max>1000</interval_max>
        <http_socket_timeout>10000</http_socket_timeout>
        <http_connect_timeout>5000</http_connect_timeout>
        <backup_intervals>10</backup_intervals>
    </parameters>
    <url_levels name="All Levels">
        <level id="50">
            <!-- list page -->
            <plugin name="listPage" class="XPath" level="99">
                <xpath>
                    //div[contains(@class,'main_col')]//div[contains(@class,'product_main')]/h2/a/@href
                </xpath>
                <plugin class="Replace">
                    <regex>(.*)</regex>
                    <result>\1</result>
                </plugin>
            </plugin>
        </level>

        <level id="100" merge="focus">
            <plugin name="calendarPirce" class="MultipleConcat" level="110" response-headers="Server">
                <part>http://vacations.ctrip.com/bookingnext/Calendar/CalendarInfo?ProductID=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'ProductID:')],'ProductID:'),',')</part>
                <part>&amp;StartCity=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'StartCityID:')],'StartCityID:'),',')</part>
                <part>&amp;SalesCity=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'SalesCity:')],'SalesCity:'),',')</part>
                <part>&amp;MinPrice=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'bigCalendarParemeter')],'"minPrice":'),',')</part>
                <part>&amp;EffectDate=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'bigCalendarParemeter')],'"effectDate":"'),'"')</part>
                <part>&amp;ExpireDate=</part>
                <part type="XPath">substring-before(substring-after(//script[contains(child::text(),'bigCalendarParemeter')],'"expireDate":"'),'"')</part>
            </plugin>
        </level>

        <level id="110" merge="100"/>
    </url_levels>
</configs>
